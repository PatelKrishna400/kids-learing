<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WonderKids - Fun Learning Adventure</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Fredoka:wght@300;400;500;600;700&family=Nunito:wght@400;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="voice-engine.js"></script>
</head>

<body>
    <nav class="navbar">
        <div class="container">
            <a href="#" class="logo">
                <i class="fa-solid fa-rocket"></i> WonderKids
            </a>
            <div class="nav-links">
                <a href="#home" class="active">Home</a>
                <a href="#features">Features</a>
                <a href="shorts.html">E-Learning</a>
                <a href="#contact">Contact</a>
            </div>
            <div class="nav-buttons">
                <div class="coin-display">
                    <i class="fa-solid fa-coins"></i> <span id="userCoins">50</span>
                </div>
                <a href="parents.html" class="btn-secondary" style="font-size: 0.9rem; border: 1px solid #ddd;"><i
                        class="fa-solid fa-shield-cat"></i> Parents Panel</a>
                <a href="#" class="btn-secondary" id="loginBtn">Log In</a>
                <a href="#" class="btn-primary" id="signupBtn">Sign Up Free</a>
            </div>
            <div class="hamburger">
                <i class="fa-solid fa-bars"></i>
            </div>
        </div>
    </nav>

    <header id="home" class="hero">
        <div class="container hero-container">
            <div class="hero-content">
                <span class="badge">#1 Learning Platform for Kids</span>
                <h1>Unlock Your Child's <span class="highlight">Potential</span> Through Play</h1>
                <p>Interactive games, coding challenges, and creative lessons designed to make learning fun and
                    effective for kids ages 4-12.</p>
                <div class="hero-btns">
                    <a href="shorts.html" class="btn-primary btn-lg">Start Learning Now <i
                            class="fa-solid fa-arrow-right"></i></a>
                    <a href="https://www.youtube.com/watch?v=S9V94NfX-iA" target="_blank" class="btn-outline btn-lg"><i
                            class="fa-solid fa-play"></i> Watch Demo</a>
                </div>
                <div class="stats">
                    <div class="stat-item">
                        <strong>10k+</strong>
                        <span>Happy Students</span>
                    </div>
                    <div class="stat-item">
                        <strong>500+</strong>
                        <span>Fun Lessons</span>
                    </div>
                    <div class="stat-item">
                        <strong>4.9/5</strong>
                        <span>Parent Rating</span>
                    </div>
                </div>
            </div>
            <div class="hero-visual">
                <div class="floating-card card-1">
                    <i class="fa-solid fa-star"></i>
                    <span>Math Whiz!</span>
                </div>
                <div class="floating-card card-2">
                    <i class="fa-solid fa-paintbrush"></i>
                    <span>Colour Fill</span>
                </div>
                <div class="floating-card card-3">
                    <i class="fa-solid fa-palette"></i>
                    <span>Art</span>
                </div>
                <div class="hero-blob"></div>
                <!-- In a real scenario, this would be an image/illustration -->
                <div class="hero-mascot">
                    <img src="assets/mascot_alphabet.png" alt="WonderKids Mascot"
                        style="width: 100%; height: 100%; object-fit: contain;">
                </div>
            </div>
        </div>
        <div class="wave-bottom">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320">
                <path fill="#ffffff" fill-opacity="1"
                    d="M0,96L48,112C96,128,192,160,288,160C384,160,480,128,576,112C672,96,768,96,864,112C960,128,1056,160,1152,160C1248,160,1344,128,1392,112L1440,96L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z">
                </path>
            </svg>
        </div>
    </header>

    <section id="features" class="features">
        <div class="container">
            <div class="section-header">
                <span class="subtitle">Why Choose Us?</span>
                <h2>Learning Made <span class="highlight">Awesome</span></h2>
                <p>We combine education with entertainment to keep kids engaged and eager to learn more every day.</p>
            </div>
            <div class="features-grid">
                <div class="feature-card clickable" id="gamifiedLearningCard">
                    <div class="icon-box color-1">
                        <i class="fa-solid fa-gamepad"></i>
                    </div>
                    <h3>Gamified Learning</h3>
                    <p>Master skills with fun games!</p>
                </div>
                <div class="feature-card clickable" id="colorFillCard">
                    <div class="icon-box color-2">
                        <i class="fa-solid fa-fill-drip"></i>
                    </div>
                    <h3>Colour Fill</h3>
                    <p>Express creativity by filling beautiful sketches with a vibrant palette of colours.</p>
                </div>
                <div class="feature-card clickable" id="storiesCard">
                    <div class="icon-box color-3">
                        <i class="fa-solid fa-book-open"></i>
                    </div>
                    <h3>Interactive Stories</h3>
                    <p>Immerse in magical stories that teach reading comprehension and vocabulary.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- More sections could be added here (Games Showcase, Testimonials, etc.) -->

    <section class="cta-section">
        <div class="container">
            <div class="cta-content">
                <h2>Ready to Start the Adventure?</h2>
                <p>Join thousands of happy parents and kids today. First month is on us!</p>
                <a href="#" class="btn-white btn-lg">Get Started for Free</a>
            </div>
        </div>
    </section>

    <footer id="contact">
        <div class="container">
            <div class="footer-content">
                <div class="footer-brand">
                    <a href="#" class="logo footer-logo">
                        <i class="fa-solid fa-rocket"></i> WonderKids
                    </a>
                    <p>Making education fun, accessible, and effective for the next generation of thinkers and creators.
                    </p>
                    <div class="social-links">
                        <a href="#"><i class="fa-brands fa-facebook-f"></i></a>
                        <a href="#"><i class="fa-brands fa-twitter"></i></a>
                        <a href="#"><i class="fa-brands fa-instagram"></i></a>
                        <a href="#"><i class="fa-brands fa-youtube"></i></a>
                    </div>
                </div>
                <div class="footer-links">
                    <h4>Platform</h4>
                    <ul>
                        <li><a href="#">Home</a></li>
                        <li><a href="#">Browse Games</a></li>
                        <li><a href="#">Pricing</a></li>
                        <li><a href="#">For Schools</a></li>
                    </ul>
                </div>
                <div class="footer-links">
                    <h4>Support</h4>
                    <ul>
                        <li><a href="#">Help Center</a></li>
                        <li><a href="#">Privacy Policy</a></li>
                        <li><a href="#">Terms of Service</a></li>
                        <li><a href="admin.html" style="color: var(--primary); font-weight: 700;"><i
                                    class="fa-solid fa-wand-magic-sparkles"></i> Creator Panel</a></li>
                    </ul>
                </div>
                <div class="footer-newsletter">
                    <h4>Stay Updated</h4>
                    <p>Subscribe for the latest games and learning tips.</p>
                    <form class="newsletter-form">
                        <input type="email" placeholder="Enter your email">
                        <button type="submit"><i class="fa-solid fa-paper-plane"></i></button>
                    </form>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2026 WonderKids Learning Platform. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <div id="gameModal" class="modal-overlay">
        <div class="game-modal">
            <div class="modal-header">
                <button class="back-modal-btn" id="gameModalBack"><i class="fa-solid fa-arrow-left"></i> Back</button>
                <div class="coin-display" style="position: static; transform: none; box-shadow: none;">
                    <i class="fa-solid fa-coins"></i> <span id="modalUserCoins">50</span>
                </div>
                <h2 id="modalTitle">Learning Games üéÆ</h2>
                <div class="game-count-badge" id="gameCountBadge">50 Games</div>
                <button class="close-modal">&times;</button>
            </div>

            <div class="modal-body">
                <!-- Main Category View -->
                <div id="categoryView" class="modal-view active">
                    <div class="game-tools">
                        <input type="text" id="gameSearchInput" class="game-search-input"
                            placeholder="Search among 50 games..." autocomplete="off">
                        <div class="game-count" id="gameCount">50 Games</div>
                    </div>
                    <div class="category-menu" id="mainGameGrid">
                        <!-- Games will be injected here by JavaScript -->
                    </div>
                </div>

                <!-- Number Levels View -->
                <div id="numberLevelsView" class="modal-view">
                    <div id="numbersGrid" class="levels-grid active">
                        <!-- Filled by JS -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Stories Modal (Gamified Interface) -->
    <div id="storiesModal" class="modal-overlay">
        <div class="game-modal full-screen">
            <div class="modal-header">
                <div class="coin-display" style="position: static; margin-right: auto;">
                    <i class="fa-solid fa-coins"></i> <span id="storyUserCoins">50</span>
                </div>
                <h2 style="margin: 0 auto; font-size: 1.5rem;">Interactive Stories üìö</h2>
                <button class="close-modal"
                    onclick="document.getElementById('storiesModal').classList.remove('active')">&times;</button>
            </div>

            <div class="modal-body" style="background: #fdfcf0; border-radius: 20px; padding: 20px;">
                <div class="category-tabs"
                    style="display: flex; justify-content: center; gap: 15px; margin-bottom: 25px;">
                    <button class="tab-btn active" onclick="filterStories('mythology', this)">Mythology</button>
                    <button class="tab-btn" onclick="filterStories('legends', this)">Legends</button>
                    <button class="tab-btn" onclick="filterStories('fables', this)">Fables</button>
                </div>

                <div id="storiesGrid" class="category-menu"
                    style="grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));">
                    <!-- Stories will be injected here -->
                </div>
            </div>
        </div>
    </div>

    <script src="gamification.js"></script>
    <script src="gamification-hud.js"></script>
    <script src="script.js"></script>
    <script>
        // Initialize Gamification System
        const gamification = window.wonderKidsGamification;

        // Sync coins from gamification system
        function syncCoins() {
            const coins = gamification.getCoins();
            const coinDisplays = ['userCoins', 'modalUserCoins', 'storyUserCoins'];
            coinDisplays.forEach(id => {
                const el = document.getElementById(id);
                if (el) el.innerText = coins;
            });
        }

        // Daily Reward Logic with enhanced gamification
        function checkDailyReward() {
            const result = gamification.claimDailyBonus();

            if (result) {
                syncCoins();

                const rewardNotice = document.createElement('div');
                rewardNotice.style.cssText = `
                    position: fixed; top: 20px; right: 20px; background: linear-gradient(135deg, #2ecc71, #27ae60); color: white; 
                    padding: 20px 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                    z-index: 10000; animation: slideIn 0.5s ease;
                `;
                rewardNotice.innerHTML = `
                    <div style="font-size: 2rem;">üéÅ</div>
                    <div><strong>Daily Bonus!</strong></div>
                    <div style="font-size: 1.5rem; font-weight: 800;">+${result.coins} Coins</div>
                    ${result.streak > 1 ? `<div style="font-size: 0.9rem; opacity: 0.9;">üî• ${result.streak} Day Streak!</div>` : ''}
                `;
                document.body.appendChild(rewardNotice);

                // Show streak info
                if (result.streak > 1) {
                    const streakPopup = document.createElement('div');
                    streakPopup.style.cssText = `
                        position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
                        font-size: 4rem; font-weight: 900; color: #e74c3c;
                        text-shadow: 0 0 20px rgba(231, 76, 60, 0.5); z-index: 10001;
                        animation: streakPop 1s ease forwards;
                    `;
                    streakPopup.textContent = `${result.streak}x STREAK!`;
                    document.body.appendChild(streakPopup);
                    setTimeout(() => streakPopup.remove(), 1000);
                }

                setTimeout(() => {
                    rewardNotice.style.opacity = '0';
                    rewardNotice.style.transition = '0.5s';
                    setTimeout(() => rewardNotice.remove(), 500);
                }, 5000);
            }
        }

        // Initialize
        syncCoins();
        checkDailyReward();

        // DEBUG: Validate DOM elements
        console.log('--- Validating Required DOM Elements ---');
        const requiredElements = [
            'gameModal', 'gamifiedLearningCard', 'categoryView', 'numberLevelsView',
            'numbersGrid', 'modalTitle', 'gameSearchInput', 'gameCount', 'gameCountBadge'
        ];
        requiredElements.forEach(id => {
            const el = document.getElementById(id);
            console.log(`Element #${id}: ${el ? 'FOUND' : 'MISSING'}`);
        });

        // Modal Logic

        // Add CSS for animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100px); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes streakPop {
                0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
                50% { transform: translate(-50%, -50%) scale(1.5); opacity: 1; }
                100% { transform: translate(-50%, -50%) scale(2); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
        const gameModal = document.getElementById('gameModal');
        const gamifiedCard = document.getElementById('gamifiedLearningCard');
        const closeBtn = document.querySelector('#gameModal .close-modal');
        const backBtn = document.getElementById('gameModalBack');
        const categoryView = document.getElementById('categoryView');
        const numberLevelsView = document.getElementById('numberLevelsView');
        const numbersGrid = document.getElementById('numbersGrid');
        const modalTitle = document.getElementById('modalTitle');
        const actualModal = document.querySelector('.game-modal');
        const gameSearchInput = document.getElementById('gameSearchInput');
        const gameCountLabel = document.getElementById('gameCount');
        const gameCountBadge = document.getElementById('gameCountBadge');

        // Game Category Mapping
        const gameCategoryMap = {
            'alphabet-game': 'language',
            'alphabet-dance': 'language',
            'balloon-pop': 'action',
            'shape-builder': 'creative',
            'color-match-train': 'creative',
            'word-builder': 'language',
            'number-fishing': 'math',
            'science-lab': 'science',
            'memory-game': 'memory',
            'animal-sounds': 'science',
            'time-clock': 'math',
            'math-racing': 'math',
            'sentence-builder': 'language',
            'solar-system': 'science',
            'multiplication-monster': 'math',
            'puzzle-map-india': 'science',
            'coding-robot': 'memory',
            'treasure-hunt': 'memory',
            'math-jump': 'math',
            'plant-simulator': 'science',
            'food-sorter': 'social',
            'grammar-ninja': 'language',
            'pizza-fractions': 'math',
            'division-bowling': 'math',
            'flag-match': 'science',
            'money-shop': 'math',
            'story-maker': 'language',
            'brain-maze': 'memory',
            'body-puzzle': 'science',
            'weather-maker': 'science',
            'recycling-game': 'science',
            'rocket-math': 'math',
            'pattern-detective': 'memory',
            'magic-table': 'math',
            'robot-coding': 'memory',
            'word-search': 'language',
            'count-stars': 'math',
            'bridge-math': 'math',
            'logic-escape': 'memory',
            'opposite-battle': 'language',
            'emoji-match': 'language',
            'city-builder': 'creative',
            'tutor-pet': 'social',
            'ar-shapes': 'creative',
            'classroom-sim': 'social',
            'story-adventure': 'language',
            'quiz-tournament': 'action',
            'garden-builder': 'creative',
            'game-maker': 'memory'
        };

        function playGame(gameName, url) {
            const gamification = window.wonderKidsGamification;
            const coins = gamification.getCoins();
            const cost = 1;

            if (coins >= cost) {
                // Get game category from URL
                const gameId = url.replace('.html', '');
                const category = gameCategoryMap[gameId] || 'memory';

                // Store current game info in sessionStorage for the game to use
                sessionStorage.setItem('currentGameId', gameId);
                sessionStorage.setItem('currentGameCategory', category);

                // Deduct coin
                const stats = gamification.getStats();
                gamification.stats.coins -= cost;
                gamification.saveStats();

                // Update displays
                syncCoins();

                // Show encouraging message
                const messages = [
                    "Let's go! üöÄ",
                    "Have fun! üéÆ",
                    "Time to learn! üìö",
                    "Adventure awaits! ‚≠ê"
                ];
                const message = messages[Math.floor(Math.random() * messages.length)];
                console.log(message);

                window.location.href = url;
            } else {
                // Not enough coins - show earning options
                alert("‚ùå Not enough coins!\n\nWays to earn coins:\n‚Ä¢ Daily login bonus\n‚Ä¢ Complete challenges\n‚Ä¢ Get correct answers\n‚Ä¢ Achieve high scores");
            }
        }

        function showNumberLevels() {
            categoryView.classList.remove('active');
            numberLevelsView.classList.add('active');
            backBtn.classList.add('active');
            actualModal.classList.remove('full-screen');
            modalTitle.innerText = "Number Master üî¢";
            populateNumbers();
        }

        function populateNumbers() {
            numbersGrid.innerHTML = '';
            for (let i = 1; i <= 100; i++) {
                const card = document.createElement('div');
                card.className = 'level-card';
                card.innerHTML = `<i class="fa-solid fa-arrow-up-9-1"></i><span>${i}</span><div class="cost">1 ü™ô</div>`;
                card.addEventListener('click', () => playGame(`Number ${i}`, `number-game.html?level=${i}`));
                numbersGrid.appendChild(card);
            }
        }

        const gameCatalog = [
            { id: 'alphabet', title: 'Alphabet Master', type: 'special' },
            { id: 'number', title: 'Number Master', type: 'special' },
            { id: 'balloon-pop', title: 'Alphabet Balloon Pop', type: 'special', color: 'linear-gradient(135deg, #FF8C42, #FFB633)' },
            { id: 'shape-builder', title: 'Shape Builder World', type: 'special', color: 'linear-gradient(135deg, #4cc9f0, #4895ef)' },
            { id: 'color-train', title: 'Color Match Train', type: 'special', color: 'linear-gradient(135deg, #a2d2ff, #777)' },
            { id: 'word-builder', title: 'Word Builder Blocks', type: 'special', color: 'linear-gradient(135deg, #8d6e63, #d7ccc8)' },
            { id: 'number-fishing', title: 'Number Fishing Game', type: 'special', color: 'linear-gradient(135deg, #00aaff, #0077be)' },
            { id: 'science-lab', title: 'Science Lab Mini', type: 'special', color: 'linear-gradient(135deg, #9c27b0, #00bcd4)' },
            { id: 'memory-game', title: 'Memory Card Match', type: 'special', color: 'linear-gradient(135deg, #6c5ce7, #a29bfe)' },
            { id: 'animal-sounds', title: 'Animal Sound Match', type: 'special', color: 'linear-gradient(135deg, #2d6a4f, #74c69d)' },
            { id: 'time-clock', title: 'Time Clock Challenge', type: 'special', color: 'linear-gradient(135deg, #6c5ce7, #3498db)' },
            { id: 'math-racing', title: 'Math Racing', type: 'special', color: 'linear-gradient(135deg, #e74c3c, #f1c40f)' },
            { id: 'sentence-builder', title: 'Sentence Builder', type: 'special', color: 'linear-gradient(135deg, #4a90e2, #5c67f2)' },
            { id: 'solar-explorer', title: 'Solar System Explorer', type: 'special', color: 'linear-gradient(135deg, #0b0d17, #4a90e2)' },
            { id: 'multi-monster', title: 'Multiplication Monster', type: 'special', color: 'linear-gradient(135deg, #9b59b6, #8e44ad)' },
            { id: 'puzzle-map-india', title: 'Puzzle Map India', type: 'special', color: 'linear-gradient(135deg, #ff9f43, #ff7f50)' },
            { id: 'coding-robot', title: 'Robot Coder (Blockly)', type: 'special', color: 'linear-gradient(135deg, #3498db, #2980b9)' },
            { id: 'treasure-hunt', title: 'Treasure Hunt Numbers', type: 'special', color: 'linear-gradient(135deg, #27ae60, #f1c40f)' },
            { id: 'math-jump', title: 'Math Jump Adventure', type: 'special', color: 'linear-gradient(135deg, #87CEEB, #2ecc71)' },
            { id: 'plant-growing', title: 'Plant Growing Sim', type: 'special', color: 'linear-gradient(135deg, #4CAF50, #8BC34A)' },
            { id: 'food-sorter', title: 'Healthy Food Sorter', type: 'special', color: 'linear-gradient(135deg, #FF9F43, #FF6B6B)' },
            { id: 'grammar-ninja', title: 'Grammar Ninja', type: 'special', color: 'linear-gradient(135deg, #2c3e50, #e74c3c)' },
            { id: 'pizza-fractions', title: 'Fraction Pizza Maker', type: 'special', color: 'linear-gradient(135deg, #e67e22, #f1c40f)' },
            { id: 'division-bowling', title: 'Division Bowling', type: 'special', color: 'linear-gradient(135deg, #f39c12, #2c3e50)' },
            { id: 'flag-match', title: 'Geography Flag Match', type: 'special', color: 'linear-gradient(135deg, #3498db, #2ecc71)' },
            { id: 'money-shop', title: 'Money Counting Shop', type: 'special', color: 'linear-gradient(135deg, #8d6e63, #f1c40f)' },
            { id: 'story-maker', title: 'Magical Story Maker', type: 'special', color: 'linear-gradient(135deg, #6c5ce7, #00cec9)' },
            { id: 'brain-maze', title: 'Brain Maze Logic', type: 'special', color: 'linear-gradient(135deg, #6c5ce7, #2d3436)' },
            { id: 'body-puzzle', title: 'Human Body Puzzle', type: 'special', color: 'linear-gradient(135deg, #ff7675, #74b9ff)' },
            { id: 'weather-maker', title: 'Weather Maker', type: 'special', color: 'linear-gradient(135deg, #4facfe, #a1c4fd)' },
            { id: 'recycling-game', title: 'Eco-Sorter Recycling', type: 'special', color: 'linear-gradient(135deg, #2dcc70, #27ae60)' },
            { id: 'rocket-math', title: 'Space Rocket Math', type: 'special', color: 'linear-gradient(135deg, #0b0d17, #6c5ce7)' },
            { id: 'pattern-detective', title: 'Pattern Detective', type: 'special', color: 'linear-gradient(135deg, #6c5ce7, #00cec9)' },
            { id: 'magic-table', title: 'Magic Multiplication Table', type: 'special', color: 'linear-gradient(135deg, #6c5ce7, #fdcb6e)' },
            { id: 'robot-coding', title: 'Robot Coding Path', type: 'special', color: 'linear-gradient(135deg, #6c5ce7, #ff7675)' },
            { id: 'word-search', title: 'Word Search Jungle', type: 'special', color: 'linear-gradient(135deg, #27ae60, #1b4d3e)' },
            { id: 'count-stars', title: 'Count the Stars', type: 'special', color: 'linear-gradient(135deg, #090a0f, #3498db)' },
            { id: 'bridge-math', title: 'Missing Number Bridge', type: 'special', color: 'linear-gradient(135deg, #8d6e63, #4fc3f7)' },
            { id: 'logic-escape', title: 'Logical Door Escape', type: 'special', color: 'linear-gradient(135deg, #1e272e, #6c5ce7)' },
            { id: 'opposite-battle', title: 'Opposite Words Battle', type: 'special', color: 'linear-gradient(135deg, #ff7675, #74b9ff)' },
            { id: 'emoji-match', title: 'Emoji Meaning Match', type: 'special', color: 'linear-gradient(135deg, #6c5ce7, #00cec9)' },
            { id: 'city-builder', title: 'Build Your City', type: 'special', color: 'linear-gradient(135deg, #4facfe, #00f2fe)' },
            { id: 'tutor-pet', title: 'AI Talking Tutor Pet', type: 'special', color: 'linear-gradient(135deg, #6c5ce7, #a29bfe)' },
            { id: 'ar-shapes', title: 'AR Shape Finder', type: 'special', color: 'linear-gradient(135deg, #00cec9, #0984e3)' },
            { id: 'classroom-sim', title: 'Virtual Classroom Simulator', type: 'special', color: 'linear-gradient(135deg, #6c5ce7, #a29bfe)' },
            { id: 'story-adventure', title: 'Story Adventure RPG', type: 'special', color: 'linear-gradient(135deg, #e67e22, #d35400)' },
            { id: 'alphabet-dance', title: 'Dance with Alphabets', type: 'special', color: 'linear-gradient(135deg, #ff4757, #54a0ff)' },
            { id: 'quiz-tournament', title: 'Mini Quiz Tournament', type: 'special', color: 'linear-gradient(135deg, #6c5ce7, #fdcb6e)' },
            { id: 'garden-builder', title: 'Smart Garden Builder', type: 'special', color: 'linear-gradient(135deg, #2ecc71, #27ae60)' },
            { id: 'game-maker', title: 'Build Your Own Game', type: 'special', color: 'linear-gradient(135deg, #6c5ce7, #fdcb6e)' }
        ];

        const allGames = gameCatalog.filter((game, index, catalog) => index === catalog.findIndex((item) => item.id === game.id));

        // DEBUG: Log game catalog
        console.log(`--- Game Catalog: ${allGames.length} games loaded ---`);
        allGames.forEach(game => console.log(`Game: ${game.title} (ID: ${game.id})`));

        function populateGameGrid(games = allGames) {
            const grid = document.getElementById('mainGameGrid');
            grid.innerHTML = '';

            gameCountLabel.innerText = `${games.length} Games`;
            gameCountBadge.innerText = `${allGames.length} Games`;

            if (!games.length) {
                grid.innerHTML = `<div class="empty-games">No games matched your search.</div>`;
                return;
            }

            games.forEach(game => {
                const banner = document.createElement('div');

                if (game.id === 'alphabet') {
                    banner.className = 'alphabet-master-banner';
                    banner.onclick = () => playGame('Alphabet Master', 'alphabet-game.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('assets/mascot_alphabet.png')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'number') {
                    banner.className = 'number-master-banner';
                    banner.onclick = showNumberLevels;
                    banner.innerHTML = `
                        <div class="kid-container" style="left: auto; right: 10px;"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/kid-with-tablet.svg'); transform: scaleX(-1);"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'balloon-pop') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Alphabet Balloon Pop', 'balloon-pop.html');
                    banner.innerHTML = `
                         <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/dancing.svg')"></div></div>
                         <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'shape-builder') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Shape Builder World', 'shape-builder.html');
                    banner.innerHTML = `
                         <div class="kid-container" style="left: auto; right: 10px;"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/abstract-shapes.svg');"></div></div>
                         <div class="banner-content" style="margin-left: 15px;"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'color-train') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Color Match Train', 'color-match-train.html');
                    banner.innerHTML = `
                         <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/location-search.svg')"></div></div>
                         <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'word-builder') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Word Builder Blocks', 'word-builder.html');
                    banner.innerHTML = `
                         <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/studying.svg')"></div></div>
                         <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'number-fishing') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Number Fishing Game', 'number-fishing.html');
                    banner.innerHTML = `
                         <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/meditating.svg')"></div></div>
                         <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'science-lab') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Science Lab Mini', 'science-lab.html');
                    banner.innerHTML = `
                         <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/shaking-hands.svg')"></div></div>
                         <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'memory-game') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Memory Card Match', 'memory-game.html');
                    banner.innerHTML = `
                         <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/student-going-to-school.svg')"></div></div>
                         <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'animal-sounds') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Animal Sound Match', 'animal-sounds.html');
                    banner.innerHTML = `
                         <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/monkey.svg')"></div></div>
                         <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'time-clock') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Time Clock Challenge', 'time-clock.html');
                    banner.innerHTML = `
                         <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/reading-a-book.svg')"></div></div>
                         <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'math-racing') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Math Racing', 'math-racing.html');
                    banner.innerHTML = `
                         <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/location-search.svg')"></div></div>
                         <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'sentence-builder') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Sentence Builder', 'sentence-builder.html');
                    banner.innerHTML = `
                         <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/reading-side.svg')"></div></div>
                         <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'solar-explorer') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Solar System Explorer', 'solar-system.html');
                    banner.innerHTML = `
                         <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/meditating.svg')"></div></div>
                         <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'multi-monster') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Multiplication Monster', 'multiplication-monster.html');
                    banner.innerHTML = `
                         <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/surreal-city.svg')"></div></div>
                         <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'puzzle-map-india') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Puzzle Map India', 'puzzle-map-india.html');
                    banner.innerHTML = `
                         <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/location-search.svg')"></div></div>
                         <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'coding-robot') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Robot Coder', 'coding-robot.html');
                    banner.innerHTML = `
                         <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/surreal-city.svg')"></div></div>
                         <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'treasure-hunt') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Treasure Hunt Numbers', 'treasure-hunt.html');
                    banner.innerHTML = `
                         <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/explorer.svg')"></div></div>
                         <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'math-jump') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Math Jump Adventure', 'math-jump.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('assets/mascot_math_cloud.png')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'plant-growing') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Plant Growing Sim', 'plant-simulator.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/location-search.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'food-sorter') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Healthy Food Sorter', 'food-sorter.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/surreal-city.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'grammar-ninja') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Grammar Ninja', 'grammar-ninja.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/student-going-to-school.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'pizza-fractions') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Fraction Pizza Maker', 'pizza-fractions.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/abstract-shapes.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'division-bowling') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Division Bowling', 'division-bowling.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/student-going-to-school.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'flag-match') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Geography Flag Match', 'flag-match.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/location-search.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'money-shop') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Money Counting Shop', 'money-shop.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/abstract-shapes.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'story-maker') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Magical Story Maker', 'story-maker.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/abstract-shapes.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'brain-maze') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Brain Maze Logic', 'brain-maze.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/meditating.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'body-puzzle') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Human Body Puzzle', 'body-puzzle.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/student-going-to-school.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'weather-maker') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Weather Maker', 'weather-maker.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/abstract-shapes.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'recycling-game') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Eco-Sorter Recycling', 'recycling-game.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/location-search.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'rocket-math') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Space Rocket Math', 'rocket-math.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/surreal-city.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'pattern-detective') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Pattern Detective', 'pattern-detective.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/surreal-city.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'magic-table') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Magic Multiplication Table', 'magic-table.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/abstract-shapes.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'robot-coding') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Robot Coding Path', 'robot-coding.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/meditating.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'word-search') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Word Search Jungle', 'word-search.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/location-search.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'count-stars') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Count the Stars', 'count-stars.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/surreal-city.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'bridge-math') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Missing Number Bridge', 'bridge-math.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/surreal-city.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'logic-escape') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Logical Door Escape', 'logic-escape.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/abstract-shapes.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'opposite-battle') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Opposite Words Battle', 'opposite-battle.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/abstract-shapes.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'emoji-match') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Emoji Meaning Match', 'emoji-match.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/location-search.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'city-builder') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Build Your City', 'city-builder.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/abstract-shapes.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'tutor-pet') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('AI Talking Tutor Pet', 'tutor-pet.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/meditating.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'ar-shapes') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('AR Shape Finder', 'ar-shapes.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/location-search.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'classroom-sim') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Virtual Classroom Simulator', 'classroom-sim.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/abstract-shapes.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'story-adventure') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Story Adventure RPG', 'story-adventure.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/location-search.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'alphabet-dance') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Dance with Alphabets', 'alphabet-dance.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/abstract-shapes.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'quiz-tournament') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Mini Quiz Tournament', 'quiz-tournament.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/meditating.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'garden-builder') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Smart Garden Builder', 'garden-builder.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/abstract-shapes.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                } else if (game.id === 'game-maker') {
                    banner.className = 'game-banner';
                    banner.style.background = game.color;
                    banner.onclick = () => playGame('Build Your Own Game', 'game-maker.html');
                    banner.innerHTML = `
                        <div class="kid-container"><div class="kid-illustration" style="background-image: url('https://illustrations.popsy.co/white/abstract-shapes.svg')"></div></div>
                        <div class="banner-content"><h3>${game.title}</h3></div>
                    `;
                }
                grid.appendChild(banner);
            });
        }
        populateGameGrid();

        function applyGameSearch() {
            const query = gameSearchInput.value.trim().toLowerCase();
            if (!query) {
                populateGameGrid(allGames);
                return;
            }

            const filteredGames = allGames.filter((game) => {
                const normalizedId = game.id.replace(/-/g, ' ');
                return game.title.toLowerCase().includes(query) || normalizedId.includes(query);
            });

            populateGameGrid(filteredGames);
        }

        gameSearchInput.addEventListener('input', applyGameSearch);

        backBtn.addEventListener('click', () => {
            numberLevelsView.classList.remove('active');
            categoryView.classList.add('active');
            backBtn.classList.remove('active');
            actualModal.classList.add('full-screen');
            modalTitle.innerText = "Learning Games üéÆ";
        });

        gamifiedCard.addEventListener('click', () => {
            gameModal.classList.add('active');
            categoryView.classList.add('active');
            numberLevelsView.classList.remove('active');
            backBtn.classList.remove('active');
            actualModal.classList.add('full-screen');
            modalTitle.innerText = "Learning Games üéÆ";
            gameSearchInput.value = '';
            populateGameGrid(allGames);
        });

        closeBtn.addEventListener('click', () => gameModal.classList.remove('active'));
        gameModal.addEventListener('click', (e) => { if (e.target === gameModal) gameModal.classList.remove('active'); });
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                gameModal.classList.remove('active');
                document.getElementById('storiesModal').classList.remove('active');
            }
        });

        // Other cards
        document.getElementById('colorFillCard').addEventListener('click', () => {
            if (coins >= 1) {
                coins -= 1; updateCoinDisplay();
                window.location.href = "color-fill.html";
            } else alert("‚ùå Not enough coins!");
        });

        document.getElementById('storiesCard').addEventListener('click', () => {
            document.getElementById('storiesModal').classList.add('active');
            filterStories('mythology', document.querySelector('#storiesModal .tab-btn'));
        });

        const allStories = {
            mythology: [
                { id: 'ramayan', title: 'The Epic Ramayan', color: 'linear-gradient(135deg, #ff9f43, #ff7f50)', icon: 'fa-om', url: 'stories.html?id=ramayan' },
                { id: 'mahabharat', title: 'The Great Mahabharat', color: 'linear-gradient(135deg, #ee5253, #ff6b6b)', icon: 'fa-dharmachakra', url: 'stories.html?id=mahabharat' },
                { id: 'krishna', title: 'Lord Krishna Tales', color: 'linear-gradient(135deg, #4834d4, #686de0)', icon: 'fa-feather', url: 'stories.html?id=krishna' }
            ],
            legends: [
                { id: 'akbar-birbal', title: 'Akbar & Birbal', color: 'linear-gradient(135deg, #f0932b, #ffbe76)', icon: 'fa-crown', url: 'stories.html?id=akbar-birbal' },
                { id: 'tenali-raman', title: 'Tenali Raman Wisdom', color: 'linear-gradient(135deg, #6ab04c, #badc58)', icon: 'fa-brain', url: 'stories.html?id=tenali-raman' },
                { id: 'maharana-pratap', title: 'Maharana Pratap', color: 'linear-gradient(135deg, #eb4d4b, #ff7979)', icon: 'fa-shield-halved', url: 'stories.html?id=pratap' }
            ],
            fables: [
                { id: 'panchatantra', title: 'Panchatantra Tales', color: 'linear-gradient(135deg, #009432, #A3CB38)', icon: 'fa-paw', url: 'stories.html?id=panchatantra' },
                { id: 'jataka-tales', title: 'Jataka Tales', color: 'linear-gradient(135deg, #1289A7, #12CBC4)', icon: 'fa-lotus', url: 'stories.html?id=jataka' },
                { id: 'vikram-betal', title: 'Vikram and Betal', color: 'linear-gradient(135deg, #130f40, #535c68)', icon: 'fa-ghost', url: 'stories.html?id=vikram' }
            ]
        };

        function filterStories(category, btn) {
            const tabs = document.querySelectorAll('#storiesModal .tab-btn');
            tabs.forEach(t => t.classList.remove('active'));
            if (btn) btn.classList.add('active');

            const grid = document.getElementById('storiesGrid');
            grid.innerHTML = '';

            allStories[category].forEach(story => {
                const banner = document.createElement('div');
                banner.className = 'game-banner';
                banner.style.background = story.color;
                banner.style.width = "100%"; // Full width in grid
                banner.onclick = () => {
                    const cost = 1;
                    if (coins >= cost) {
                        coins -= cost;
                        updateCoinDisplay();
                        alert(`ü™ô 1 Coin used for Story! Enjoy!`);
                        window.location.href = story.url;
                    } else {
                        alert("‚ùå Not enough coins!");
                    }
                };
                banner.innerHTML = `
                    <div style="width: 70px; height: 70px; background: rgba(255,255,255,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-left:15px; border: 2px solid white;">
                        <i class="fa-solid ${story.icon}" style="font-size: 2rem; color: white;"></i>
                    </div>
                    <div class="banner-content" style="margin-left: 20px;">
                        <h3 style="color: white; font-size: 1.2rem;">${story.title}</h3>
                        <div style="background: rgba(0,0,0,0.2); padding: 4px 10px; border-radius: 10px; color: white; display: inline-block; font-size: 0.8rem; margin-top:5px;">
                             <i class="fa-solid fa-coins"></i> 1 
                        </div>
                    </div>
                `;
                grid.appendChild(banner);
            });
        }

    </script>
</body>

</html>